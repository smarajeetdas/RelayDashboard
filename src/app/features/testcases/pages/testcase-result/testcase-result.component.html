<div class="result-container">
  <!-- Breadcrumb navigation -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a [routerLink]="['/']">Home</a></li>
      <li class="breadcrumb-item"><a [routerLink]="['/testcases']">Test Cases</a></li>
      <li class="breadcrumb-item active" aria-current="page">Result</li>
    </ol>
  </nav>

  <!-- Loading spinner -->
  <div *ngIf="loading" class="loading-spinner">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
    <p class="mt-3">Loading test results...</p>
  </div>

  <div *ngIf="!loading && error" class="alert alert-danger">
    <i class="fas fa-exclamation-circle me-2"></i> {{ error }}
    <button class="btn btn-outline-danger btn-sm ms-3" (click)="goBack()">
      Back to Test Case
    </button>
  </div>

  <div *ngIf="!loading && !error && testResult">
    <!-- Result header section based on reference design -->
    <div class="result-header">
      <div class="header-content">
        <div class="header-left">
          <h1 class="test-name">{{ testResult.name || 'Global Suite' }}</h1>
          
          <div class="test-metadata">
            <div class="status-badge bg-{{ getStatusClass(testResult.status) }}">Status: {{ testResult.status }}</div>
            <div class="env-badge">Env: {{ testResult.environment || 'Windows' }}</div>
            <div class="test-id">Run Manager: FT Stage</div>
          </div>
          
          <div class="execution-details">
            <div class="execution-item">
              <span class="label">Executed on:</span> 
              <span class="value">{{ testResult.startTime | date:'dd-MM-yyyy, HH:mm:ss' }}</span>
            </div>
            <div class="execution-item">
              <span class="label">Executed by:</span> 
              <span class="value">{{ testResult.executedBy || 'test@example.com' }}</span>
            </div>
          </div>
        </div>
        
        <div class="header-right">
          <div class="browser-info">
            <span class="label">Browser:</span> 
            <span class="value">{{ testResult.browser || 'Chrome' }}</span>
          </div>
          <div class="user-info">
            <i class="fas fa-user-circle user-icon"></i>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Test Data Sequence -->
    <div class="test-data-sequence">
      <div class="sequence-header">
        <span class="sequence-title">Test Data Sequence:</span>
        <span class="sequence-number">1</span>
        <span class="sequence-separator">|</span>
        <span class="sequence-type">Primary - {{ testResult.status }}</span>
      </div>
    </div>
    
    <!-- Test Stats -->
    <div class="test-stats">
      <div class="stat-item">
        <span class="stat-label">Steps:</span>
        <span class="stat-value">{{ filteredTestSteps.length }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Passed:</span>
        <span class="stat-value">{{ getPassedStepsCount() }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Wait Avg:</span>
        <span class="stat-value">{{ getAverageWaitTime() }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Time taken:</span>
        <span class="stat-value">{{ testResult.duration || '16 seconds' }}</span>
      </div>
    </div>
    
    <!-- Endpoints Section -->
    <div class="endpoints-section">
      <h3 class="section-title">Endpoints</h3>
      
      <div class="table-responsive">
        <table class="data-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Category</th>
              <th>Start Time</th>
              <th>End Time</th>
              <th>Response</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="filteredTestSteps.length === 0">
              <td colspan="6" class="no-results">No test steps match the current filters.</td>
            </tr>
            <tr *ngFor="let step of filteredTestSteps" class="endpoint-row">
              <td>
                <div class="step-name">
                  <i *ngIf="step.category === 'API'" class="fas fa-globe step-icon"></i>
                  <i *ngIf="step.category === 'Setup'" class="fas fa-cog step-icon"></i>
                  <i *ngIf="step.category === 'Validation'" class="fas fa-check-circle step-icon"></i>
                  <span>{{ step.name }}</span>
                </div>
              </td>
              <td>
                <span class="category-badge">{{ step.category }}</span>
              </td>
              <td>{{ step.startTime | date:'HH:mm:ss' }}</td>
              <td>{{ step.endTime | date:'HH:mm:ss' }}</td>
              <td>
                <span class="response-time">{{ step.responseTime }} ms</span>
              </td>
              <td>
                <span class="status-indicator bg-{{ getStatusClass(step.status) }}">{{ step.status }}</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    
    <!-- Tab Navigation -->
    <div class="tab-container">
      <div class="tab-navigation">
        <div class="tab-item" [ngClass]="{'active': activeTab === 'steps'}" (click)="setActiveTab('steps')">
          <i class="fas fa-list-ul me-2"></i> Step Execution
        </div>
        <div class="tab-item" [ngClass]="{'active': activeTab === 'data'}" (click)="setActiveTab('data')">
          <i class="fas fa-table me-2"></i> Test Data
        </div>
        <div class="tab-item" [ngClass]="{'active': activeTab === 'validation'}" (click)="setActiveTab('validation')">
          <i class="fas fa-check-double me-2"></i> Validation Results
        </div>
        <div class="tab-item" [ngClass]="{'active': activeTab === 'dom'}" (click)="setActiveTab('dom')">
          <i class="fas fa-code me-2"></i> DOM Extraction
        </div>
        <div class="tab-item" [ngClass]="{'active': activeTab === 'response'}" (click)="setActiveTab('response')">
          <i class="fas fa-exchange-alt me-2"></i> Response Extractor
        </div>
      </div>
      
      <!-- Tab content -->
      <div class="tab-content">
        <!-- Step Execution Tab -->
        <div class="tab-pane" [ngClass]="{'active': activeTab === 'steps'}">
          <div class="step-execution-table">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Index</th>
                  <th>Locator</th>
                  <th>Input</th>
                  <th>Action</th>
                  <th>Wait Time</th>
                  <th>Response(ms)</th>
                  <th>Status</th>
                  <th>Screenshot</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let i of [0, 1, 2, 3, 4, 5, 6, 7]" class="step-row">
                  <td>{{ i + 1 }}</td>
                  <td>{{ ['IT_Editor.field.title.input', 'Edit_Editor', 'Update_Values', 'IT_EditorMode.new', 'IT_EditorMode.raw', 'IT_EditorMode.row.value', 'IT_Editor.from.editor.list', 'Edit_Editor'][i] }}</td>
                  <td>{{ ['', '', '', '', '', '', '', ''][i] }}</td>
                  <td>CLICK</td>
                  <td>{{ [0.658, 2.146, 2.566, 0.098, 0.054, 0.023, 0.158, 2.171][i] }}</td>
                  <td>{{ [124, 2146, 2566, 98, 54, 23, 158, 2171][i] }}</td>
                  <td>
                    <span class="status-indicator bg-passed">Passed</span>
                  </td>
                  <td>
                    <a href="#" class="screenshot-link">View</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <!-- Test Data Tab -->
        <div class="tab-pane" [ngClass]="{'active': activeTab === 'data'}">
          <div class="no-data-message">
            Test data not available in this version.
          </div>
        </div>
        
        <!-- Validation Results Tab -->
        <div class="tab-pane" [ngClass]="{'active': activeTab === 'validation'}">
          <div class="validation-status mb-4">
            <span class="status-indicator bg-{{ getStatusClass(testResult.validationStatus || 'Passed') }}">
              {{ testResult.validationStatus || 'Passed' }}
            </span>
          </div>
          
          <div class="no-data-message">
            Detailed validation results are not available in this version.
          </div>
        </div>
        
        <!-- DOM Extraction Tab -->
        <div class="tab-pane" [ngClass]="{'active': activeTab === 'dom'}">
          <div class="no-data-message">
            DOM extraction data not available in this version.
          </div>
        </div>
        
        <!-- Response Extractor Tab -->
        <div class="tab-pane" [ngClass]="{'active': activeTab === 'response'}">
          <div class="no-data-message">
            Response extraction data not available in this version.
          </div>
        </div>
      </div>
    </div>
    
    <!-- Back button -->
    <div class="text-start my-4">
      <button class="btn btn-outline-secondary" (click)="goBack()">
        <i class="fas fa-arrow-left me-2"></i> Back
      </button>
    </div>
  </div>
</div>